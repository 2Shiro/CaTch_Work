<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.catwork.mapper.CompanyMapper"> 

	<!-- 전체 공고 가져오기 -->
	<!-- 마감지난 건 안뜨고 마감기한 낮은 순으로 정렬됨 -->
	<select id="getmainpostList">
		SELECT	POST_IDX,
				USER_IDX,
				TITLE,
				TRUNC(DEADLINE) - TRUNC(SYSDATE) AS DEADLINE_ORDER,
				'D-' || TO_CHAR(TRUNC(DEADLINE) - TRUNC(SYSDATE)) AS DEADLINE,
				TO_CHAR(SYSDATE, 'YY/MM/DD')
		FROM	POST_TB
		WHERE	TO_CHAR(DEADLINE, 'YYYYMMDD') >= TO_CHAR(SYSDATE, 'YYYYMMDD')
		ORDER BY DEADLINE_ORDER
	</select>
	
	<!-- 기업 회원 중 특정 아이디의 컴퍼니 info를 가져옴 -->
	<select id="getCompanyById">
		SELECT	USER_IDX,
				LOGO,
				NAME
		FROM	COMPANY_TB
		WHERE	USER_IDX = #{user_idx}
	</select>
	
	<!-- 검색 공고 가져오기 -->
	<!-- 마감지난 건 안뜨고 마감기한 낮은 순으로 정렬됨 -->
	<select id="searchPostsByKeyword">
	    SELECT  POST_IDX,
	            USER_IDX,
	            TITLE,
	            TRUNC(DEADLINE) - TRUNC(SYSDATE) AS DEADLINE_ORDER,
	            'D-' || TO_CHAR(TRUNC(DEADLINE) - TRUNC(SYSDATE)) AS DEADLINE,
	            TO_CHAR(SYSDATE, 'YY/MM/DD')
	    FROM    POST_TB
	    WHERE   TO_CHAR(DEADLINE, 'YYYYMMDD') >= TO_CHAR(SYSDATE, 'YYYYMMDD')
	            AND TITLE LIKE '%' || #{keyword} || '%'
	    ORDER BY DEADLINE_ORDER
	</select>
	
	<!-- 이력서 리스트 가져오기 -->
	<select id="getResumeList">
		SELECT RESUME_IDX, USER_IDX, TITLE, IMAGE, LINK, INTRO, TO_CHAR(CREATED, 'YYYY-MM-DD') CREATED, TYPE FROM RESUME_TB
	</select>

	<!-- 기술 이름 가져오기 -->
	<select id="getSkillName">
		SELECT SKILL_IDX, NAME FROM SKILL_TB WHERE SKILL_IDX = #{skill_idx}
	</select>

</mapper>